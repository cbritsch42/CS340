<!doctype html>
dp[i][j] = Math.min(costSub, costDel, costIns);
}
}
return dp[n][m];
}


// attempt to fetch dictionary.txt from same folder
let DICT = [];
async function loadDictByFetch(){
try{
const r = await fetch('dictionary.txt');
if(!r.ok) throw new Error('Fetch failed');
const txt = await r.text();
DICT = txt.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
renderPreview();
return true;
}catch(e){
console.warn('Auto-load failed',e);
return false;
}
}


function loadDictFromFile(file){
const reader = new FileReader();
reader.onload = e=>{
const txt = e.target.result;
DICT = txt.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
renderPreview();
};
reader.readAsText(file);
}


function renderPreview(){
const p = document.getElementById('preview');
p.textContent = DICT.slice(0,200).join('\n');
}


document.getElementById('fetchDict').addEventListener('click', async ()=>{
const ok = await loadDictByFetch();
if(!ok) alert('Could not fetch dictionary.txt automatically. You can upload the file using the file input on the right.');
});


document.getElementById('dictFile').addEventListener('change', e=>{
const f = e.target.files[0]; if(f) loadDictFromFile(f);
});


document.getElementById('check').addEventListener('click', ()=>{
const word = document.getElementById('word').value.trim();
if(!word){ alert('Enter a word to check.'); return; }
if(DICT.length===0){ alert('Dictionary not loaded. Click "Load dictionary.txt" or upload a dictionary file.'); return; }
const topN = 10;
// compute scores
const out = DICT.map(w=>({w,score:alignScore(word,w)}));
out.sort((a,b)=>a.score - b.score || a.w.localeCompare(b.w));
const results = out.slice(0, topN);
const resultsEl = document.getElementById('results');
resultsEl.innerHTML = '';
results.forEach(r=>{
const div = document.createElement('div'); div.className='suggestion';
div.innerHTML = `<div><strong>${escapeHtml(r.w)}</strong><div class='small'>score: ${r.score}</div></div><div style='min-width:80px;text-align:right'><button data-word='${escapeHtml(r.w)}'>Use</button></div>`;
div.querySelector('button').addEventListener('click',()=>{
document.getElementById('word').value = r.w;
});
resultsEl.appendChild(div);
});
});


document.getElementById('clear').addEventListener('click', ()=>{
document.getElementById('word').value=''; document.getElementById('results').innerHTML='<div class="small">Cleared.</div>';
});


function escapeHtml(s){ return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }


// try to auto-load on page open
loadDictByFetch().then(ok=>{
if(!ok){ const p = document.getElementById('preview'); p.textContent = 'dictionary.txt not found via fetch; upload a dictionary .txt file using the file chooser.'; }
});
</script>
</body>
</html>
